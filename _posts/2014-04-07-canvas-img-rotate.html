---
layout: post
title: canvas 实现图片转动效果
category: javascript
---

<canvas id="myCanvas" style="width:240px;height:100px;border:1px solid red;"></canvas>
<pre>
&lt;canvas id="myCanvas" style="width:240px;height:100px;border:1px solid red;"&gt;&lt;/canvas&gt;
&lt;script&gt;
    var ctx,pic,i=0;
    //检测浏览器是否支持触摸
    var screen_w = 'ontouchstart' in window ? screen.width : document.body.clientWidth;
    var pic_w = null;
    window.load=function(){
        ctx = document.getElementById('myCanvas').getContext('2d');//getContext() 内建的HTML5对象，返回一个用于画布上绘图的环境
        pic = new Image();
        pic.src='http://www.f2es.net/img/rotate.png';
        //pic.src = screen_w<480 ? 'loading.png': screen_w >= 480 && screen_w <= 640 ? 'loading-1.png':'loading-x.png';
        setInterval(rotate,100);
    }
    function rotate(){
        console.log(1)
        ctx.save();//保存当前环境的状态
        i += Math.PI/6;
        pic_w = pic_w || pic.width;
        ctx.translate(pic_w/2,pic_w/2);//重新映射画布上的位置
        ctx.rotate(i);//旋转当前绘图
        ctx.clearRect(-pic_w/2,-pic_w/2,pic_w,pic_w);//在规定的矩形内清除指定的像素
        ctx.drawImage(pic,-pic_w/2,-pic_w/2);//在画布上绘制图像,指定x、y 坐标
        ctx.restore();//返回之前保存过的路径状态和属性
    }
&lt;/script&gt;
</pre>
<script>
    var ctx,pic,i=0;
    //检测浏览器是否支持触摸
    var screen_w = 'ontouchstart' in window ? screen.width : document.body.clientWidth;
    var pic_w = null;
    window.load=function(){
        ctx = document.getElementById('myCanvas').getContext('2d');//getContext() 内建的HTML5对象，返回一个用于画布上绘图的环境
        pic = new Image();
        pic.src='http://www.f2es.net/img/rotate.png';
        //pic.src = screen_w<480 ? 'loading.png': screen_w >= 480 && screen_w <= 640 ? 'loading-1.png':'loading-x.png';
        setInterval(rotate,100);
    }
    function rotate(){
        console.log(1)
        ctx.save();//保存当前环境的状态
        i += Math.PI/6;
        pic_w = pic_w || pic.width;
        ctx.translate(pic_w/2,pic_w/2);//重新映射画布上的位置
        ctx.rotate(i);//旋转当前绘图
        ctx.clearRect(-pic_w/2,-pic_w/2,pic_w,pic_w);//在规定的矩形内清除指定的像素
        ctx.drawImage(pic,-pic_w/2,-pic_w/2);//在画布上绘制图像,指定x、y 坐标
        ctx.restore();//返回之前保存过的路径状态和属性
    }
</script>