---
layout: post
title: 弹框
category: jQuery
---

<style type="text/css">
.win{z-index:99;position:fixed;width:500px;font-family:'microsoft yahei';border:1px solid #eee;box-shadow:5px 5px 10px #000;_position:absolute;}
	.win-hd{position:relative;padding:10px;background:#eee;background:-webkit-gradient(linear, left top, left bottom,color-stop(0,#fff),color-stop(1, #ccc));}
		.win-hd h3{color:#666;font-weight:400;font-size:16px;text-shadow:1px 1px 1px #fff;}
		.win-close{cursor:pointer;position:absolute;right:10px;top:10px;font-size:12px;color:#999;}
	.win-bd{padding:10px;color:#999;background:#fff;}
.win-mask{z-index:98;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);}
</style>
<a href="javascript:;" class='showWin link'>点击查看效果</a>
<pre>
	/* 调用弹窗 */
	$('.showWin').click(function(){
		$.showWin({obj:'win',
				  width:'400px',
				  title:'标题',
				  content:'弹窗内容',
				  mask:1
		});
	})
</pre>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script>
(function(){
	$.extend({
		showWin:function(options){
			var defaults={
				obj:'',
				width:'',
				height:'',
				title:'',
				content:'',
				mask:0,
				botton:[{className:''},{className:''}]
			};
			var opts=$.extend(defaults,options);
			
			if(!opts.obj) return false;
			
			//是否显示遮罩
			if(opts.mask){
				if($('.win-mask').length){
					$('.win-mask').show();
				}else{
					var w_width=$(window).width(),w_height=$(window).height();
					$('body').append('<div class="win-mask" style="width:'+w_width+';height:'+w_height+'"></div>');
				}
				$('html,body').css('overflow','hidden').find('.wrap').addClass('filter');
			}
			if(!$('#'+opts.obj).length){
				var h='<div id="'+opts.obj+'" class="win" style="display:none;width:'+opts.width+';">';
					h+='<div class="win-hd"><h3>'+opts.title+'</h3><span class="win-close" title="关闭">X</span></div>';
					h+='<div class="win-bd">'+opts.content+'</div>';
					h+='</div>';
				$('body').append(h);
			}
			var o=$('#'+opts.obj);
			o.slideDown(100);
			$('.win-mask').fadeIn(300);
			
			var win={
				//关闭弹窗
				close:function(e){
					$('.win-mask').fadeOut(300);
					o.slideUp(100);
					$('.wrap').removeClass('filter');
				},
				//设置弹窗左边距
				left:function(){
					var w_obj=o.outerWidth();
					var w_window=$(window).width();
					o.css('left',(w_window-w_obj)/2);
				},
				//设置弹窗上边距
				top:function(){
					var h_obj=o.find('.win-hd').outerHeight()+o.find('.win-bd').outerHeight();//获取弹框高度
					//var h_obj=o.outerHeight();
					var h_window=$(window).height();
					o.css('top',(h_window-h_obj)/2);
				}
			}
			
			win.left();
			win.top();
			
			$(window).bind('resize',function(){
				win.left();
				win.top();
			})
			
			$('.win-close,.win-mask').bind('click',function(){
				win.close();
				return false;
			})
		}
	});
})(jQuery);
$('.showWin').click(function(){
	$.showWin({obj:'win',width:'400px',title:'标题',content:'弹窗内容',mask:1});
})

/*=S 拖拽 待优化*/
var x=y=0,m=false;	
$('body').delegate('.win-hd','mousedown',function(e){
	m=true;
	var $self=$(this);
	$self.css('cursor','move')
	var win=$self.parent();
	x=e.pageX-win.offset().left;
	y=e.pageY-win.offset().top;
	win.fadeTo(300,.6);
})
$(document).mousemove(function(e){
	if(m){
		$('.win').css({left:e.pageX-x,top:e.pageY-y});
	}
}).mouseup(function(){
	if(m){
		m=false;
		$('.win').fadeTo(300,1);
	}
})
/*=E 拖拽 */
</script>
