---
layout: post
title: 弹框
category: jQuery
---

<div><a href="http://f2es.net/demo/show_window.html">Demo</a></div>
<br>
<pre>
/* 调用弹窗 */
$('.showWin').click(function(){
    $.showWin({obj:'win',
        width:'400px',
        title:'标题',
        content:'弹窗内容',
        mask:1
    });
})
</pre>
<pre>
(function(){
    $.extend({
        showWin:function(options){
            var defaults={
                obj:'',
                width:'',
                height:'',
                title:'标题',
                content:'',
                mask:0,
                button:[{className:''},{className:''}]
            };
            var opts=$.extend(defaults,options);
            
            if(!opts.obj) return false;
            

            if(!$('#'+opts.obj).length){
                var h = [
                    '&lt;div id="'+opts.obj+'" class="win" style="display:none;width:'+opts.width+';"&gt;',
                    '&lt;div class="win-hd">&lt;h3>'+opts.title+'&lt;/h3&gt;&lt;a href="#" class="win-close" title="关闭"&gt;X&lt;/a&gt;&lt;/div&gt;',
                    '&lt;div class="win-bd">'+opts.content+'&lt;/div&gt;',
                    '&lt;/div&gt;'
                ];

                if(opts.mask){
                    h.push('&lt;div class="win-mask"&gt;&lt;/div&gt;');
                }

                $(document.body).append(h.join(''));
            }
            
            var o=$('#'+opts.obj);
            o.slideDown(100);
            $('.win-mask').fadeIn(300);
            
            var win={
                //关闭弹窗
                close:function(e){
                    $('.win-mask').hide();
                    o.hide();
                },
                //设置弹窗左边距
                left:function(){
                    var w_obj=o.outerWidth();
                    var w_window=$(window).width();
                    o.css('left',(w_window-w_obj)/2);
                },
                //设置弹窗上边距
                top:function(){
                    var h_obj=o.find('.win-hd').outerHeight()+o.find('.win-bd').outerHeight();//获取弹框高度
                    //var h_obj=o.outerHeight();
                    var h_window=$(window).height();
                    o.css('top',(h_window-h_obj)/2);
                }
            }
            
            win.left();
            win.top();
            
            $(window).bind('resize',function(){
                win.left();
                win.top();
            })
            
            $('.win-close').bind('click',function(){
                win.close();
            })

            winDrag('.win','.win-hd')
        }
    });

})(jQuery);


/*=S 拖拽 */
var winDrag = function(obj,obj_hd){
    var x=y=0,m=false;
    $(obj_hd).bind('mousedown',function(e){
        e=e||event;
        m=true;
        var $self=$(this);
        var win=$self.parent();
        x=e.pageX-win.offset().left;
        y=e.pageY-win.offset().top;
        win.fadeTo(300,.6);
        return false;
    })
    $(document).mousemove(function(e){
        if(m){
            var left=e.pageX-x,top=e.pageY-y-($(document).scrollTop());
            if(top&lt;=0){
                $(obj).css({left:left,top:0});
            }else if(left&lt;=0){
                $(obj).css({left:0,top:top});
            }else{
                $(obj).css({left:left,top:top});
            }
        }
    }).mouseup(function(){
        if(m){
            m=false;
            $(obj).fadeTo(300,1);
        }
    })
}
/*=E 拖拽 */


/*=E 调用 */
$('.showWin').click(function(){
    $.showWin({obj:'win',width:'400px',title:'标题',content:'弹窗内容',mask:1});
})
</pre>
