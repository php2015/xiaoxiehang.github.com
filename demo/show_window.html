<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
	*{margin:0;padding:0;}
	ul,li{list-style-type:none;}
	body{background:url(http://xiaoxiehang.h5.5vv.cc/blog/bg/5.jpg) no-repeat;background-size:100% 1000px;}
	a{font:16px 'microsoft yahei';color:#fff;}

	.win{z-index:99;position:fixed;width:500px;font-family:'microsoft yahei';border:1px solid #eee;box-shadow:5px 5px 10px #000;_position:absolute;}
	.win-hd{cursor:move;position:relative;padding:10px;background:#eee;background:-webkit-gradient(linear, left top, left bottom,color-stop(0,#fff),color-stop(1, #ccc));}
		.win-hd h3{font-weight:400;font-size:16px;text-shadow:1px 1px 1px #fff;}
		.win-close{cursor:pointer;position:absolute;right:10px;top:10px;padding:3px 8px;text-decoration:none;font-size:12px;color:#333;}
	.win-bd{padding:10px;background:#fff;}
	.win-mask{z-index:98;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);}
	</style>
</head>
<body>
<a href="javascript:;" class='showWin'>点击查看效果</a>
<div style="height:1000px;"></div>
<script src="http://f2es.net/js/jquery.js"></script>
<script>
(function(){
	$.extend({
		showWin:function(options){
			var defaults={
				obj:'',
				width:'',
				height:'',
				title:'标题',
				content:'',
				mask:0,
				button:[{className:''},{className:''}]
			};
			var opts=$.extend(defaults,options);
			
			if(!opts.obj) return false;
			

			if(!$('#'+opts.obj).length){
				var h = [
					'<div id="'+opts.obj+'" class="win" style="display:none;width:'+opts.width+';">',
					'<div class="win-hd"><h3>'+opts.title+'</h3><a href="#" class="win-close" title="关闭">X</a></div>',
					'<div class="win-bd">'+opts.content+'</div>',
					'</div>'
				];

				if(opts.mask){
					h.push('<div class="win-mask"></div>');
				}

				$(document.body).append(h.join(''));
			}
			
			var o=$('#'+opts.obj);
			o.slideDown(100);
			$('.win-mask').fadeIn(300);
			
			var win={
				//关闭弹窗
				close:function(e){
					$('.win-mask').hide();
					o.hide();
				},
				//设置弹窗左边距
				left:function(){
					var w_obj=o.outerWidth();
					var w_window=$(window).width();
					o.css('left',(w_window-w_obj)/2);
				},
				//设置弹窗上边距
				top:function(){
					var h_obj=o.find('.win-hd').outerHeight()+o.find('.win-bd').outerHeight();//获取弹框高度
					//var h_obj=o.outerHeight();
					var h_window=$(window).height();
					o.css('top',(h_window-h_obj)/2);
				}
			}
			
			win.left();
			win.top();
			
			$(window).bind('resize',function(){
				win.left();
				win.top();
			})
			
			$('.win-close').bind('click',function(){
				win.close();
			})

			winDrag('.win','.win-hd')
		}
	});

})(jQuery);


var winDrag = function(obj,obj_hd){
	/*=S 拖拽 */
	var x=y=0,m=false;
	$(obj_hd).bind('mousedown',function(e){
		e=e||event;
		m=true;
		var $self=$(this);
		var win=$self.parent();
		x=e.pageX-win.offset().left;
		y=e.pageY-win.offset().top;
		win.fadeTo(300,.6);
		return false;
	})
	$(document).mousemove(function(e){
		if(m){
			var left=e.pageX-x,top=e.pageY-y-($(document).scrollTop());
			if(top<=0){
				$(obj).css({left:left,top:0});
			}else if(left<=0){
				$(obj).css({left:0,top:top});
			}else{
				$(obj).css({left:left,top:top});
			}
		}
	}).mouseup(function(){
		if(m){
			m=false;
			$(obj).fadeTo(300,1);
		}
	})
	/*=E 拖拽 */
}




$('.showWin').click(function(){
	$.showWin({obj:'win',width:'400px',title:'标题',content:'弹窗内容',mask:1});
})
</script>
</body>
</html>