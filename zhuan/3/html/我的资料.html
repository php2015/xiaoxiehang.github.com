<!DOCTYPE html>
<html>
<head>
    <title>3人行--资料</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="../themes/css/style.css">
</head>
<body class="my-info">
<article>
    <header class="my-info-hd">
        <h2 class="show"><em>我的资料</em></h2>
        <h2><em>我的技能</em></h2>
        <h2><em>我的想学</em></h2>
    </header>
    <section class="my-info-bd">
        <div class="my-info-step1">
            <ul>
                <li><input type="text" placeholder="昵称："></li>
                <li><label><em>男</em><select><option>男</option><option>女</option></select></label></li>
                <li><input type="text" placeholder="微信号："></li>
                <li class="my-info-site">
                    <label><em>浙江省</em><select><option>浙江省</option><option>湖北省</option></select></label>
                    <label><em>杭州市</em><select><option>杭州市</option><option>温州市</option></select></label>
                    <label><em>滨江区</em><select><option>滨江区</option><option>西湖区</option></select></label>
                </li>
            </ul>
            <a href="javascript:;" class="my-info-btn">下一步</a>
        </div>
        <div class="my-info-step2">
            <div class="clearfix">
                <a href="javascript:;" class="my-info-remove" title="删除">-</a>
                <a href="javascript:;" class="my-info-add" title="添加">+</a>
            </div>
            <ul>
                <li><input type="text" placeholder="技能名称："></li>
                <li><input type="text" placeholder="熟练程度："></li>
            </ul>
            <a href="javascript:;" class="my-info-btn">下一步</a>
        </div>
        <div class="my-info-step3">
            <div class="clearfix">
                <a href="javascript:;" class="my-info-remove" title="删除">-</a>
                <a href="javascript:;" class="my-info-add" title="添加">+</a>
            </div>
            <ul>
                <li><input type="text" placeholder="我的想学1："></li>
                <li><input type="text" placeholder="我的想学2："></li>
            </ul>
            <a href="javascript:;" class="my-info-btn">完成</a>
        </div>
    </section>
</article>
<script src="../js/libs/sea.js"></script>
<script>
    seajs.config({
        alias:{
            'zepto':'zepto.min.js',
            'gmu':'gmu.min.js'
        }
    })
    seajs.use('zepto',function(){
            var ss = true;
        $(document.body).on('touchstart',function(e){
            var el = $(e.target);
            if(el.hasClass('my-info-btn')){
                if(!el.closest('.my-info-step3').length){
                    el.parent().hide().next().show();
                    $('.my-info-hd').find('.show').removeClass('show').next().addClass('show');
                }else{
                    var json = {
                        skill : [],
                        want : []
                    };
                    var skill = $('.my-info-step2').find('ul');
                    for(var i=0; i<skill.length; i++){
                        json.skill.push({
                            "name":skill.eq(i).find('li').eq(0).find('input').val(),
                            "score":skill.eq(i).find('li').eq(1).find('input').val()
                        });
                    }
                    
                    
                    var want = $('.my-info-step3').find('li');
                    for(var i=0; i<want.length; i++){
                        json.want.push({
                            "name":want.eq(i).find('input').val()
                        });
                    }
                    console.log(json);
                }
            }
            if(el.hasClass('my-info-add')){
                if(el.closest('.my-info-step3').length){
                    var size = el.siblings('ul').find('li').length + 1;
                    el.parent().siblings('ul').append('<li><input type="text" placeholder="我的想学'+ size +'："></li>')
                }else{
                    el.parent().siblings('.my-info-btn').before('<ul><li><input type="text" placeholder="技能名称："></li><li><input type="text" placeholder="熟练程度："></li></ul>');
                }
            }
            if(el.hasClass('my-info-remove')){
                if(ss){
                    if(el.parents('.my-info-step2').length){
                        el.parent().siblings('ul').css({paddingLeft:10,paddingRight:50}).append('<a href="javascript:;" class="remove-btn">删除</a>');
                        
                    }else if(el.parents('.my-info-step3').length){

                    }
                    ss = false;
                }else{
                    if(el.parents('.my-info-step2').length){
                        el.parent().siblings('ul').removeAttr('style').find('.remove-btn').remove();
                    }else if(el.parents('.my-info-step3').length){

                    }
                    ss = true;
                }
            }
        }).on('touchstart','.my-info-hd h2',function(){
            var _this = $(this);
            _this.addClass('show').siblings().removeClass('show');
            $('.my-info-bd').children().eq(_this.index()).show().siblings().hide();
        }).on('change','select',function(){
            var _this = $(this);
            _this.siblings('em').text(_this.val());
        })
    });
</script>
</body>
</html>