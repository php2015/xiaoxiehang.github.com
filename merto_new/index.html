<!Doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>xiaoxiehang</title>
<link rel="stylesheet" href="themes/css/common.css"/>
</head>
<body>
<div class="g-wrap">
    <menu class="m-menu">
        <li title="html" class="html"><em>HTML</em></li>
        <li title="tool" class="tool"><em>Tool</em></li>
        <li title="photo" class="photo h2"><em>Photo</em></li>
        <li title="css" class="css w2"><em>CSS</em></li>
        <li title="contact" class="contact h2"><em>Contact</em></li>
        <li title="javascript" class="javascript w2 h2"><em>JavaScript</em></li>
        <li title="links" class="links w2"><em>Links</em></li>
        <li title="mobile" class="mobile w2"><em>Mobile</em></li>
        <li title="demo" class="demo w2"><em>Demo</em></li>
    </menu>
</div>
<div class="m-bg"></div>
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
<script src="http://the5fireblog.b0.upaiyun.com/staticfile/underscore.js"></script>
<script src="http://the5fireblog.b0.upaiyun.com/staticfile/backbone.js"></script>
<script src="js/jquery.masonry.min.js"></script>
<script>
$(function(){
	var Menu = Backbone.Model.extend({
		initialize:function(){
			imgLoad('http://www.f2es.net/merto/bg/'+getRandom()+'.jpg');
		}
	});
	var menu = new Menu;
})

function addLoading(text){
    var h=[];
    h.push('<div class="m-loading"><div class="m-point-list">');
    for (var pointCount=1;pointCount<6;pointCount++){
        h.push('<div class="m-point" style="-webkit-animation-name:load'+pointCount+'"><i></i></div>');
    };
    h.push('</div><p class="loadText">'+text+'</p></div>');
    $('body').prepend(h.join(''));
}

var getRandom = function(){
    return Math.ceil(Math.random()*10);
}

var hslaRandom = function() {
    return "hsla(" + Math.round(360 * Math.random()) + "," + "60%, 50%, 1)";
}

$('.m-menu').find('li').each(function(){
    $(this).css({backgroundColor:hslaRandom()});
})

function imgLoad(url){
    addLoading('载入中');
    var img = new Image();
    img.onload=function(){
        img.onload=null;
        $('div.m-bg').append(img).find('img').css({width:window.screen.width,height:window.screen.height});
        //$.getScript('js/jquery.masonry.min.js').done(function(){
            $('.m-menu').masonry({itemSelector:'li'});
            $('.m-loading').fadeOut(500,function(){
                $(this).remove();
            });
            $('.m-menu').addClass('m-menu-show');
        //});
    };
    img.src=url;
}
</script>
</body>
</html>